{% extends 'detalle_listado.html' %}
{% load crispy_forms_tags %}

{% block detalle %}
<div class="container">
  <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4">
    <div class="col"><p><strong>Fecha:</strong> {{ clase.reserva.fecha }}</p></div>
    <div class="col"><p><strong>Hora Inicio:</strong> {{ clase.reserva.horario.hora_inicio }} hrs.</p></div>
    <div class="col"><p><strong>Hora fin:</strong> {{ clase.reserva.horario.hora_fin }} hrs.</p></div>
    <div class="col"><p><strong>Lugar:</strong> {{ clase.reserva.aula }}</p></div>
  </div>
</div>
{% endblock %}


{% block listado_asociado %}

<div class="container-sm">
  <h3 class="subtitulo">{{ tituloListado }}</h3>
  
  {% if inscritos %}
  <h5 class="subtitulo">{{ tituloListado1 }}</h5>
  <form method="post" action="{% url 'cursos:generar_asistencia' clase.id  %}">
    {% csrf_token %}
    <table class="table table-sm table-hover">
      <thead>
        <tr>
          {% include "tabla_persona_cabecera.html" %}
          <th>Rol</th>
          <th class="text-center">Asistencia</th>
        </tr>
      </thead>
      <tbody>
        {% for inscrito in inscritos %}
        <tr>
          {% include "tabla_persona_cuerpo.html" with persona=inscrito.persona%}
          <td>{{ inscrito.persona.obtenerTipo }}</td>
          <td class="text-center">
            <input 
            type="checkbox"
            name="alumnos_asistencia"
            value="{{ inscrito.id }}"
            {% if clase.asistencia_tomada %}disabled{% endif %}
            {% if inscrito.persona.pk in lista_asistencia %}checked{% endif %}>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <h5 class="subtitulo"> {{tituloListado2}}</h5>
    <table class="table table-sm table-hover">
      <thead>
        <tr>
          {% include "tabla_persona_cabecera.html" %}
          <th class="text-center">Asistencia</th>
        </tr>
      </thead>
      <tbody>
        {% for titular in titulares %}
        <tr>
          {% include "tabla_persona_cuerpo.html" with persona=titular.profesor.persona%}
          <td class="text-center">
            <input 
            type="checkbox"
            name="profesor__asistencia"
            value="{{ titular.profesor.id }}" 
            {% if clase.asistencia_tomada %}disabled{% endif %}
            {% if titular.profesor.persona.pk in lista_asistencia_titular %}checked{% endif %}>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    
    {% if not clase.asistencia_tomada %}
    <div class="text-center">
      <button class="btn btn-success btn-detalle" type="submit">Generar Asistencia</button>
    </div>
    {% endif %}
    
    
  </form>
</div>

  {% else %}
  <p>No hay alumnos inscriptos.</p>
  {% endif %}
  
  
  
  {% endblock %}
  
